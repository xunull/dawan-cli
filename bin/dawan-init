#!/usr/bin/env node

var program = require('commander');
var chalk = require('chalk');
var inquirer = require('inquirer');
var download = require('download-git-repo');

program
    .usage('[project-name]');

program.on('--help', function() {
    console.log('  Examples:')
    console.log()
    console.log(chalk.gray(
        '    # create a new project with an template'))
    console.log('    $ dawan init xxx')
})

inquirer.prompt([{
    type: 'list',
    name: 'core',
    message: 'which do you like?express or koa?',
    choices: ['express', 'koa'],
    filter: function(val) {
        return val.toLowerCase();
    }
}]).then(function(answers) {
    console.log(answers);
    if ('express' === answers.core) {
        /**
         * process.argv[1] 的路径是node 执行的执行文件的绝对路径
         * process.cwd() 是当前node 命令执行的目录，如pwd
         */

        download('xunull/dawan', process.cwd(), function(err) {
            if (err) {
                console.log(err);
            } else {
                console.log('dawan init success');
            }
        });
    } else {
        download('xunull/dawan-koa', process.cwd(), function(err) {
            if (err) {
                console.log(err);
            } else {
                console.log('dawan init success');
            }
        });
    }
})

/**
 * Help.
 */

function help() {
    program.parse(process.argv)
    if (program.args.length < 1) return program.help()
}
// help()

/**
 * Padding.
 */

console.log();
process.on('exit', function() {
    console.log();
})
